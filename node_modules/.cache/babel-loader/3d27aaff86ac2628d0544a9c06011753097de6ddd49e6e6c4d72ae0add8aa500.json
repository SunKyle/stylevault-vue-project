{"ast":null,"code":"/**\n * OutfitCreator 服务层\n * 提供创建搭配的独立服务，解耦组件间通信\n */\nimport { ref, computed } from 'vue';\nimport { useInspirationStore } from '@/stores/inspirationStore';\nimport { showToast } from '@/utils/toast';\nexport class OutfitCreatorService {\n  constructor() {\n    this.inspirationStore = useInspirationStore();\n    this.setupReactivity();\n    this.bindMethods();\n\n    // 确保inspirationStore已初始化\n    if (!this.inspirationStore) {\n      throw new Error('InspirationStore 初始化失败');\n    }\n  }\n\n  // 响应式数据\n  setupReactivity() {\n    this.outfitName = ref('');\n    this.outfitScene = ref([]);\n    this.outfitSeason = ref([]);\n    this.outfitStyle = ref([]);\n    this.outfitOccasion = ref([]);\n    this.outfitColor = ref([]);\n  }\n\n  // 绑定方法上下文\n  bindMethods() {\n    this.toggleCloth = this.toggleCloth.bind(this);\n    this.removeCloth = this.removeCloth.bind(this);\n    this.resetClothes = this.resetClothes.bind(this);\n    this.saveOutfit = this.saveOutfit.bind(this);\n    this.setCategory = this.setCategory.bind(this);\n    this.setTag = this.setTag.bind(this);\n    this.resetFilters = this.resetFilters.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n  }\n\n  // 获取store数据\n  get selectedClothes() {\n    return this.inspirationStore.selectedClothes;\n  }\n  get filteredClothes() {\n    return this.inspirationStore.filteredClothes;\n  }\n  get categories() {\n    return this.inspirationStore.categories;\n  }\n  get tags() {\n    return this.inspirationStore.tags;\n  }\n\n  // 核心操作方法\n  toggleCloth(item) {\n    this.inspirationStore.toggleCloth(item);\n  }\n  removeCloth(index) {\n    this.inspirationStore.removeCloth(index);\n    showToast('已从搭配中移除', 'info');\n  }\n  resetClothes() {\n    this.inspirationStore.resetClothes();\n    showToast('已清空搭配', 'info');\n  }\n  async saveOutfit() {\n    if (!this.outfitName.value.trim()) {\n      showToast('请输入搭配名称', 'error');\n      return false;\n    }\n    if (this.selectedClothes.length === 0) {\n      showToast('请至少选择一件衣物', 'error');\n      return false;\n    }\n    try {\n      await this.inspirationStore.saveOutfit({\n        name: this.outfitName.value,\n        scenes: this.outfitScene.value,\n        seasons: this.outfitSeason.value,\n        styles: this.outfitStyle.value\n      });\n\n      // 重置表单\n      this.resetForm();\n      showToast('搭配保存成功！', 'success');\n      return true;\n    } catch (error) {\n      showToast(error.message || '保存失败，请重试', 'error');\n      return false;\n    }\n  }\n  resetForm() {\n    this.outfitName.value = '';\n    this.outfitScene.value = [];\n    this.outfitSeason.value = [];\n    this.outfitStyle.value = [];\n  }\n\n  // 过滤器方法\n  setCategory(category) {\n    this.inspirationStore.setFilter('category', category);\n  }\n  setTag(tag) {\n    this.inspirationStore.setFilter('tag', tag);\n  }\n  resetFilters() {\n    this.inspirationStore.resetFilters();\n  }\n\n  // 拖拽支持\n  handleDrop(item) {\n    this.toggleCloth(item);\n    showToast('已添加到搭配', 'success');\n  }\n}\n\n// 组合式API封装\nexport function useOutfitCreator() {\n  const service = new OutfitCreatorService();\n\n  // 确保服务正确初始化\n  if (!service.inspirationStore) {\n    console.error('OutfitCreatorService: inspirationStore 未正确初始化');\n  }\n  return service;\n}","map":{"version":3,"names":["ref","computed","useInspirationStore","showToast","OutfitCreatorService","constructor","inspirationStore","setupReactivity","bindMethods","Error","outfitName","outfitScene","outfitSeason","outfitStyle","outfitOccasion","outfitColor","toggleCloth","bind","removeCloth","resetClothes","saveOutfit","setCategory","setTag","resetFilters","handleDrop","selectedClothes","filteredClothes","categories","tags","item","index","value","trim","length","name","scenes","seasons","styles","resetForm","error","message","category","setFilter","tag","useOutfitCreator","service","console"],"sources":["/Users/sunxiaokai/Desktop/stylevault-vue-project/src/services/outfitCreatorService.js"],"sourcesContent":["/**\n * OutfitCreator 服务层\n * 提供创建搭配的独立服务，解耦组件间通信\n */\nimport { ref, computed } from 'vue';\nimport { useInspirationStore } from '@/stores/inspirationStore';\nimport { showToast } from '@/utils/toast';\n\nexport class OutfitCreatorService {\n  constructor() {\n    this.inspirationStore = useInspirationStore();\n    this.setupReactivity();\n    this.bindMethods();\n\n    // 确保inspirationStore已初始化\n    if (!this.inspirationStore) {\n      throw new Error('InspirationStore 初始化失败');\n    }\n  }\n\n  // 响应式数据\n  setupReactivity() {\n    this.outfitName = ref('');\n    this.outfitScene = ref([]);\n    this.outfitSeason = ref([]);\n    this.outfitStyle = ref([]);\n    this.outfitOccasion = ref([]);\n    this.outfitColor = ref([]);\n  }\n\n  // 绑定方法上下文\n  bindMethods() {\n    this.toggleCloth = this.toggleCloth.bind(this);\n    this.removeCloth = this.removeCloth.bind(this);\n    this.resetClothes = this.resetClothes.bind(this);\n    this.saveOutfit = this.saveOutfit.bind(this);\n    this.setCategory = this.setCategory.bind(this);\n    this.setTag = this.setTag.bind(this);\n    this.resetFilters = this.resetFilters.bind(this);\n    this.handleDrop = this.handleDrop.bind(this);\n  }\n\n  // 获取store数据\n  get selectedClothes() {\n    return this.inspirationStore.selectedClothes;\n  }\n\n  get filteredClothes() {\n    return this.inspirationStore.filteredClothes;\n  }\n\n  get categories() {\n    return this.inspirationStore.categories;\n  }\n\n  get tags() {\n    return this.inspirationStore.tags;\n  }\n\n  // 核心操作方法\n  toggleCloth(item) {\n    this.inspirationStore.toggleCloth(item);\n  }\n\n  removeCloth(index) {\n    this.inspirationStore.removeCloth(index);\n    showToast('已从搭配中移除', 'info');\n  }\n\n  resetClothes() {\n    this.inspirationStore.resetClothes();\n    showToast('已清空搭配', 'info');\n  }\n\n  async saveOutfit() {\n    if (!this.outfitName.value.trim()) {\n      showToast('请输入搭配名称', 'error');\n      return false;\n    }\n\n    if (this.selectedClothes.length === 0) {\n      showToast('请至少选择一件衣物', 'error');\n      return false;\n    }\n\n    try {\n      await this.inspirationStore.saveOutfit({\n        name: this.outfitName.value,\n        scenes: this.outfitScene.value,\n        seasons: this.outfitSeason.value,\n        styles: this.outfitStyle.value,\n      });\n\n      // 重置表单\n      this.resetForm();\n      showToast('搭配保存成功！', 'success');\n      return true;\n    } catch (error) {\n      showToast(error.message || '保存失败，请重试', 'error');\n      return false;\n    }\n  }\n\n  resetForm() {\n    this.outfitName.value = '';\n    this.outfitScene.value = [];\n    this.outfitSeason.value = [];\n    this.outfitStyle.value = [];\n  }\n\n  // 过滤器方法\n  setCategory(category) {\n    this.inspirationStore.setFilter('category', category);\n  }\n\n  setTag(tag) {\n    this.inspirationStore.setFilter('tag', tag);\n  }\n\n  resetFilters() {\n    this.inspirationStore.resetFilters();\n  }\n\n  // 拖拽支持\n  handleDrop(item) {\n    this.toggleCloth(item);\n    showToast('已添加到搭配', 'success');\n  }\n}\n\n// 组合式API封装\nexport function useOutfitCreator() {\n  const service = new OutfitCreatorService();\n\n  // 确保服务正确初始化\n  if (!service.inspirationStore) {\n    console.error('OutfitCreatorService: inspirationStore 未正确初始化');\n  }\n\n  return service;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}