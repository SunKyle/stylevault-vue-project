{"ast":null,"code":"import { computed, ref, watch } from 'vue';\nimport { useClothingStore } from '@/stores/clothingStore';\nimport ClothingItem from '../ui/ClothingItem.vue';\nexport default {\n  __name: 'FavoriteSection',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const clothingStore = useClothingStore();\n\n    // 状态\n    const favoriteIndex = ref(0);\n    const itemsPerPage = ref(12); // 每页显示12个物品\n    const selectedCategory = ref(''); // 选中的分类筛选\n    const sortBy = ref('recent'); // 排序方式\n\n    // 计算属性\n    const categories = computed(() => clothingStore.categories);\n    const favoriteItems = computed(() => clothingStore.favoriteItems);\n\n    // 筛选和排序后的收藏物品\n    const filteredFavoriteItems = computed(() => {\n      let result = [...favoriteItems.value];\n\n      // 分类筛选\n      if (selectedCategory.value) {\n        result = result.filter(item => item.categoryId === selectedCategory.value);\n      }\n\n      // 排序\n      switch (sortBy.value) {\n        case 'recent':\n          result.sort((a, b) => new Date(b.purchaseDate) - new Date(a.purchaseDate));\n          break;\n        case 'name':\n          result.sort((a, b) => a.name.localeCompare(b.name));\n          break;\n        case 'brand':\n          result.sort((a, b) => {\n            const brandA = a.brand || '';\n            const brandB = b.brand || '';\n            return brandA.localeCompare(brandB);\n          });\n          break;\n      }\n      return result;\n    });\n\n    // 当前页显示的收藏物品\n    const displayedFavoriteItems = computed(() => {\n      return filteredFavoriteItems.value.slice(favoriteIndex.value, favoriteIndex.value + itemsPerPage.value);\n    });\n\n    // 分页计算\n    const currentPage = computed(() => Math.floor(favoriteIndex.value / itemsPerPage.value) + 1);\n    const totalPages = computed(() => Math.ceil(filteredFavoriteItems.value.length / itemsPerPage.value));\n    const loading = computed(() => clothingStore.loading);\n    const error = computed(() => clothingStore.error);\n\n    // 方法\n    function prevFavorite() {\n      if (favoriteIndex.value > 0) favoriteIndex.value -= itemsPerPage.value;\n    }\n    function nextFavorite() {\n      if (favoriteIndex.value < filteredFavoriteItems.value.length - itemsPerPage.value) {\n        favoriteIndex.value += itemsPerPage.value;\n      }\n    }\n\n    // 当筛选条件变化时，重置分页\n    function resetPagination() {\n      favoriteIndex.value = 0;\n    }\n\n    // 监听筛选条件变化\n    watch([selectedCategory, sortBy], () => {\n      resetPagination();\n    });\n    async function toggleFavorite(item) {\n      try {\n        await clothingStore.toggleFavorite(item.id);\n      } catch (error) {\n        console.error('切换收藏状态失败:', error);\n      }\n    }\n    const __returned__ = {\n      clothingStore,\n      favoriteIndex,\n      itemsPerPage,\n      selectedCategory,\n      sortBy,\n      categories,\n      favoriteItems,\n      filteredFavoriteItems,\n      displayedFavoriteItems,\n      currentPage,\n      totalPages,\n      loading,\n      error,\n      prevFavorite,\n      nextFavorite,\n      resetPagination,\n      toggleFavorite,\n      computed,\n      ref,\n      watch,\n      get useClothingStore() {\n        return useClothingStore;\n      },\n      ClothingItem\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","ref","watch","useClothingStore","ClothingItem","clothingStore","favoriteIndex","itemsPerPage","selectedCategory","sortBy","categories","favoriteItems","filteredFavoriteItems","result","value","filter","item","categoryId","sort","a","b","Date","purchaseDate","name","localeCompare","brandA","brand","brandB","displayedFavoriteItems","slice","currentPage","Math","floor","totalPages","ceil","length","loading","error","prevFavorite","nextFavorite","resetPagination","toggleFavorite","id","console"],"sources":["/Users/sunxiaokai/Desktop/stylevault-vue-project/src/components/wardrobe/FavoriteSection.vue"],"sourcesContent":["<template>\n  <div v-if=\"!loading && !error && favoriteItems.length > 0\" class=\"container mx-auto px-4 mb-12\">\n    <div class=\"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4\">\n      <div class=\"flex items-center space-x-2\">\n        <h3 class=\"text-xl md:text-2xl font-bold\">我的收藏</h3>\n        <span class=\"px-2 py-1 bg-primary/10 text-primary rounded-full text-xs font-medium\">\n          {{ filteredFavoriteItems.length }}\n        </span>\n      </div>\n\n      <!-- 筛选项 -->\n      <div class=\"flex flex-wrap gap-2\">\n        <div class=\"flex items-center space-x-2 bg-white rounded-lg px-3 py-1.5 shadow-sm\">\n          <font-awesome-icon :icon=\"['fas', 'filter']\" class=\"text-neutral-500 text-xs\" />\n          <select\n            v-model=\"selectedCategory\"\n            class=\"text-sm bg-transparent border-none focus:outline-none focus:ring-0 text-gray-700\"\n          >\n            <option value=\"\">所有分类</option>\n            <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\n              {{ category.name }}\n            </option>\n          </select>\n        </div>\n\n        <div class=\"flex items-center space-x-2 bg-white rounded-lg px-3 py-1.5 shadow-sm\">\n          <font-awesome-icon :icon=\"['fas', 'sort']\" class=\"text-neutral-500 text-xs\" />\n          <select\n            v-model=\"sortBy\"\n            class=\"text-sm bg-transparent border-none focus:outline-none focus:ring-0 text-gray-700\"\n          >\n            <option value=\"recent\">最近添加</option>\n            <option value=\"name\">名称</option>\n            <option value=\"brand\">品牌</option>\n          </select>\n        </div>\n\n        <div class=\"flex items-center space-x-2\">\n          <span class=\"text-sm text-gray-500\">{{ currentPage }} / {{ totalPages }}</span>\n          <div class=\"flex space-x-1\">\n            <button\n              @click=\"prevFavorite\"\n              :disabled=\"favoriteIndex === 0\"\n              class=\"w-8 h-8 rounded-full bg-white shadow-soft flex items-center justify-center hover:bg-neutral-50 disabled:opacity-30 disabled:cursor-not-allowed transition-all\"\n            >\n              <font-awesome-icon :icon=\"['fas', 'chevron-left']\" class=\"text-neutral-600 text-xs\" />\n            </button>\n            <button\n              @click=\"nextFavorite\"\n              :disabled=\"favoriteIndex >= filteredFavoriteItems.length - itemsPerPage\"\n              class=\"w-8 h-8 rounded-full bg-white shadow-soft flex items-center justify-center hover:bg-neutral-50 disabled:opacity-30 disabled:cursor-not-allowed transition-all\"\n            >\n              <font-awesome-icon\n                :icon=\"['fas', 'chevron-right']\"\n                class=\"text-neutral-600 text-xs\"\n              />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"relative overflow-hidden\">\n      <transition-group\n        name=\"favorite-fade\"\n        tag=\"div\"\n        class=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-5\"\n      >\n        <ClothingItem\n          v-for=\"item in displayedFavoriteItems\"\n          :key=\"item.id\"\n          :item=\"item\"\n          :showInFavoriteMode=\"true\"\n          @like=\"toggleFavorite(item)\"\n        />\n      </transition-group>\n    </div>\n  </div>\n</template>\n\n<script setup>\n  import { computed, ref, watch } from 'vue';\n  import { useClothingStore } from '@/stores/clothingStore';\n  import ClothingItem from '../ui/ClothingItem.vue';\n\n  const clothingStore = useClothingStore();\n\n  // 状态\n  const favoriteIndex = ref(0);\n  const itemsPerPage = ref(12); // 每页显示12个物品\n  const selectedCategory = ref(''); // 选中的分类筛选\n  const sortBy = ref('recent'); // 排序方式\n\n  // 计算属性\n  const categories = computed(() => clothingStore.categories);\n  const favoriteItems = computed(() => clothingStore.favoriteItems);\n\n  // 筛选和排序后的收藏物品\n  const filteredFavoriteItems = computed(() => {\n    let result = [...favoriteItems.value];\n\n    // 分类筛选\n    if (selectedCategory.value) {\n      result = result.filter(item => item.categoryId === selectedCategory.value);\n    }\n\n    // 排序\n    switch (sortBy.value) {\n      case 'recent':\n        result.sort((a, b) => new Date(b.purchaseDate) - new Date(a.purchaseDate));\n        break;\n      case 'name':\n        result.sort((a, b) => a.name.localeCompare(b.name));\n        break;\n      case 'brand':\n        result.sort((a, b) => {\n          const brandA = a.brand || '';\n          const brandB = b.brand || '';\n          return brandA.localeCompare(brandB);\n        });\n        break;\n    }\n\n    return result;\n  });\n\n  // 当前页显示的收藏物品\n  const displayedFavoriteItems = computed(() => {\n    return filteredFavoriteItems.value.slice(\n      favoriteIndex.value,\n      favoriteIndex.value + itemsPerPage.value\n    );\n  });\n\n  // 分页计算\n  const currentPage = computed(() => Math.floor(favoriteIndex.value / itemsPerPage.value) + 1);\n  const totalPages = computed(() =>\n    Math.ceil(filteredFavoriteItems.value.length / itemsPerPage.value)\n  );\n  const loading = computed(() => clothingStore.loading);\n  const error = computed(() => clothingStore.error);\n\n  // 方法\n  function prevFavorite() {\n    if (favoriteIndex.value > 0) favoriteIndex.value -= itemsPerPage.value;\n  }\n\n  function nextFavorite() {\n    if (favoriteIndex.value < filteredFavoriteItems.value.length - itemsPerPage.value) {\n      favoriteIndex.value += itemsPerPage.value;\n    }\n  }\n\n  // 当筛选条件变化时，重置分页\n  function resetPagination() {\n    favoriteIndex.value = 0;\n  }\n\n  // 监听筛选条件变化\n  watch([selectedCategory, sortBy], () => {\n    resetPagination();\n  });\n\n  async function toggleFavorite(item) {\n    try {\n      await clothingStore.toggleFavorite(item.id);\n    } catch (error) {\n      console.error('切换收藏状态失败:', error);\n    }\n  }\n</script>\n\n<style scoped>\n  /* 翻页动画效果 */\n  .favorite-fade-enter-active,\n  .favorite-fade-leave-active {\n    transition: all 0.5s ease;\n  }\n\n  .favorite-fade-enter-from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n\n  .favorite-fade-leave-to {\n    opacity: 0;\n    transform: translateY(-20px);\n  }\n\n  .favorite-fade-move {\n    transition: transform 0.5s ease;\n  }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}