{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"py-10\"\n};\nvar _hoisted_2 = {\n  \"class\": \"container mx-auto px-4\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"section\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createCommentVNode(\" 已保存搭配展示区域 \"), _createVNode($setup[\"SavedOutfits\"], {\n    savedOutfits: $setup.savedOutfits,\n    currentPage: $setup.currentPage,\n    itemsPerPage: $setup.itemsPerPage,\n    totalPages: $setup.totalPages,\n    currentPageOutfits: $setup.currentPageOutfits,\n    onLoadOutfit: $setup.loadOutfit,\n    onDeleteOutfit: $setup.deleteOutfit,\n    onShareOutfit: $setup.shareOutfit,\n    onPageChange: _cache[0] || (_cache[0] = function ($event) {\n      return $setup.currentPage = $event;\n    }),\n    onScrollToCreate: $setup.scrollToCreateSection\n  }, null, 8 /* PROPS */, [\"savedOutfits\", \"currentPage\", \"itemsPerPage\", \"totalPages\", \"currentPageOutfits\"]), _createCommentVNode(\" 创建搭配区域 \"), _createVNode($setup[\"OutfitCreator\"], {\n    selectedClothes: $setup.selectedClothes,\n    clothes: $setup.clothes,\n    categories: $setup.categories,\n    tags: $setup.tags,\n    activeCategory: $setup.activeCategory,\n    activeTag: $setup.activeTag,\n    filteredClothes: $setup.filteredClothes,\n    onToggleCloth: $setup.toggleCloth,\n    onRemoveCloth: $setup.removeCloth,\n    onResetClothes: $setup.resetClothes,\n    onSaveOutfit: $setup.saveOutfit,\n    onCategoryChange: _cache[1] || (_cache[1] = function ($event) {\n      return $setup.activeCategory = $event;\n    }),\n    onTagChange: _cache[2] || (_cache[2] = function ($event) {\n      return $setup.activeTag = $event;\n    }),\n    onResetFilters: _cache[3] || (_cache[3] = function ($event) {\n      $setup.activeCategory = '全部';\n      $setup.activeTag = '';\n    })\n  }, null, 8 /* PROPS */, [\"selectedClothes\", \"clothes\", \"categories\", \"tags\", \"activeCategory\", \"activeTag\", \"filteredClothes\"])])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createCommentVNode","_createVNode","$setup","savedOutfits","currentPage","itemsPerPage","totalPages","currentPageOutfits","onLoadOutfit","loadOutfit","onDeleteOutfit","deleteOutfit","onShareOutfit","shareOutfit","onPageChange","_cache","$event","onScrollToCreate","scrollToCreateSection","selectedClothes","clothes","categories","tags","activeCategory","activeTag","filteredClothes","onToggleCloth","toggleCloth","onRemoveCloth","removeCloth","onResetClothes","resetClothes","onSaveOutfit","saveOutfit","onCategoryChange","onTagChange","onResetFilters"],"sources":["/Users/sunxiaokai/Desktop/stylevault-vue-project/src/components/inspiration/InspirationSection.vue"],"sourcesContent":["<template>\n  <section class=\"py-10\">\n    <div class=\"container mx-auto px-4\">\n      <!-- 已保存搭配展示区域 -->\n      <SavedOutfits\n        :savedOutfits=\"savedOutfits\"\n        :currentPage=\"currentPage\"\n        :itemsPerPage=\"itemsPerPage\"\n        :totalPages=\"totalPages\"\n        :currentPageOutfits=\"currentPageOutfits\"\n        @load-outfit=\"loadOutfit\"\n        @delete-outfit=\"deleteOutfit\"\n        @share-outfit=\"shareOutfit\"\n        @page-change=\"currentPage = $event\"\n        @scroll-to-create=\"scrollToCreateSection\"\n      />\n\n      <!-- 创建搭配区域 -->\n      <OutfitCreator\n        :selectedClothes=\"selectedClothes\"\n        :clothes=\"clothes\"\n        :categories=\"categories\"\n        :tags=\"tags\"\n        :activeCategory=\"activeCategory\"\n        :activeTag=\"activeTag\"\n        :filteredClothes=\"filteredClothes\"\n        @toggle-cloth=\"toggleCloth\"\n        @remove-cloth=\"removeCloth\"\n        @reset-clothes=\"resetClothes\"\n        @save-outfit=\"saveOutfit\"\n        @category-change=\"activeCategory = $event\"\n        @tag-change=\"activeTag = $event\"\n        @reset-filters=\"\n          activeCategory = '全部';\n          activeTag = '';\n        \"\n      />\n    </div>\n  </section>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, watch } from 'vue';\nimport { useWardrobeStore } from '../../stores/wardrobeStore';\nimport { useOutfitStore } from '../../stores/outfitStore';\nimport { scenesMockData, getClothesWithTags } from '../../mock/wardrobe';\nimport SavedOutfits from './SavedOutfits.vue';\nimport OutfitCreator from './OutfitCreator.vue';\n\nconst wardrobeStore = useWardrobeStore();\nconst outfitStore = useOutfitStore();\nconst categories = computed(() => ['全部', ...wardrobeStore.categories.map(c => c.name)]);\n\n// 分页相关数据\nconst currentPage = ref(1);\nconst itemsPerPage = ref(4);\nconst isLoading = ref(true);\n\n// 从store获取数据\nconst clothes = ref([]);\nconst savedOutfits = computed(() => outfitStore.allOutfits);\n\n// 监听clothingItems变化\nwatch(\n  () => wardrobeStore.clothingItems,\n  newItems => {\n    if (newItems.length > 0) {\n      clothes.value = getClothesWithTags(newItems);\n    }\n  },\n  { immediate: true }\n);\n\n// 获取标签\nconst allTags = computed(() => {\n  const tagSet = new Set();\n  clothes.value.forEach(item => {\n    item.tags?.forEach(tag => tagSet.add(tag));\n  });\n  return Array.from(tagSet);\n});\n\nconst tags = computed(() => ['最近穿着', ...allTags.value]);\nconst activeCategory = ref('全部');\nconst activeTag = ref('');\nconst selectedClothes = ref([]);\n\n// 计算分页数据\nconst currentPageOutfits = computed(() => {\n  const start = (currentPage.value - 1) * itemsPerPage.value;\n  const end = start + itemsPerPage.value;\n  return savedOutfits.value.slice(start, end);\n});\n\nconst totalPages = computed(() => {\n  return Math.ceil(savedOutfits.value.length / itemsPerPage.value);\n});\n\n// 组件挂载时初始化数据\nonMounted(async () => {\n  await outfitStore.fetchOutfits();\n  isLoading.value = false;\n\n  // 异步加载其他数据\n  Promise.all([\n    wardrobeStore.categories.length === 0 ? wardrobeStore.fetchCategories() : Promise.resolve(),\n    wardrobeStore.clothingItems.length === 0 ? wardrobeStore.fetchClothingItems() : Promise.resolve(),\n  ]).catch(error => {\n    console.error('加载数据失败:', error);\n  });\n});\n\nconst filteredClothes = computed(() => {\n  return clothes.value.filter(item => {\n    const catMatch = activeCategory.value === '全部' || item.category === activeCategory.value;\n    const tagMatch = !activeTag.value || item.tags.includes(activeTag.value);\n    return catMatch && tagMatch;\n  });\n});\n\n// 操作方法\nfunction toggleCloth(item) {\n  const index = selectedClothes.value.findIndex(i => i.name === item.name);\n  if (index === -1) {\n    selectedClothes.value.push(item);\n  } else {\n    selectedClothes.value.splice(index, 1);\n  }\n}\n\nfunction removeCloth(idx) {\n  selectedClothes.value.splice(idx, 1);\n}\n\nfunction resetClothes() {\n  selectedClothes.value = [];\n}\n\nfunction scrollToCreateSection() {\n  const element = document.getElementById('create-section');\n  if (element) {\n    element.scrollIntoView({ behavior: 'smooth' });\n  }\n}\n\n// 使用store的方法替代直接localStorage操作\nasync function saveOutfit(outfitInfo) {\n  if (selectedClothes.value.length === 0) {\n    alert('请至少选择一件衣物');\n    return;\n  }\n\n  const newOutfit = {\n    name: outfitInfo.name,\n    scene: outfitInfo.scene || undefined,\n    items: [...selectedClothes.value],\n    createdAt: new Date(),\n  };\n\n  try {\n    await outfitStore.addOutfit(newOutfit);\n    alert('穿搭方案已保存！');\n    resetClothes();\n  } catch (error) {\n    console.error('保存搭配失败:', error);\n    alert('保存失败，请重试');\n  }\n}\n\nfunction loadOutfit(outfit) {\n  selectedClothes.value = Array.isArray(outfit.items) ? [...outfit.items] : [];\n}\n\nasync function deleteOutfit(outfit) {\n  if (confirm('确定要删除这个搭配方案吗？')) {\n    try {\n      await outfitStore.removeOutfit(outfit.id);\n    } catch (error) {\n      console.error('删除搭配失败:', error);\n      alert('删除失败，请重试');\n    }\n  }\n}\n\nfunction shareOutfit(outfit) {\n  // 使用store的分享功能\n  outfitStore.shareOutfit(outfit);\n}\n</script>\n"],"mappings":";;EACW,SAAM;AAAO;;EACf,SAAM;AAAwB;;uBADrCA,mBAAA,CAqCU,WArCVC,UAqCU,GApCRC,mBAAA,CAmCM,OAnCNC,UAmCM,GAlCJC,mBAAA,eAAkB,EAClBC,YAAA,CAWEC,MAAA;IAVCC,YAAY,EAAED,MAAA,CAAAC,YAAY;IAC1BC,WAAW,EAAEF,MAAA,CAAAE,WAAW;IACxBC,YAAY,EAAEH,MAAA,CAAAG,YAAY;IAC1BC,UAAU,EAAEJ,MAAA,CAAAI,UAAU;IACtBC,kBAAkB,EAAEL,MAAA,CAAAK,kBAAkB;IACtCC,YAAW,EAAEN,MAAA,CAAAO,UAAU;IACvBC,cAAa,EAAER,MAAA,CAAAS,YAAY;IAC3BC,aAAY,EAAEV,MAAA,CAAAW,WAAW;IACzBC,YAAW,EAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OAAEd,MAAA,CAAAE,WAAW,GAAGY,MAAM;IAAA;IACjCC,gBAAgB,EAAEf,MAAA,CAAAgB;gHAGrBlB,mBAAA,YAAe,EACfC,YAAA,CAkBEC,MAAA;IAjBCiB,eAAe,EAAEjB,MAAA,CAAAiB,eAAe;IAChCC,OAAO,EAAElB,MAAA,CAAAkB,OAAO;IAChBC,UAAU,EAAEnB,MAAA,CAAAmB,UAAU;IACtBC,IAAI,EAAEpB,MAAA,CAAAoB,IAAI;IACVC,cAAc,EAAErB,MAAA,CAAAqB,cAAc;IAC9BC,SAAS,EAAEtB,MAAA,CAAAsB,SAAS;IACpBC,eAAe,EAAEvB,MAAA,CAAAuB,eAAe;IAChCC,aAAY,EAAExB,MAAA,CAAAyB,WAAW;IACzBC,aAAY,EAAE1B,MAAA,CAAA2B,WAAW;IACzBC,cAAa,EAAE5B,MAAA,CAAA6B,YAAY;IAC3BC,YAAW,EAAE9B,MAAA,CAAA+B,UAAU;IACvBC,gBAAe,EAAAnB,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OAAEd,MAAA,CAAAqB,cAAc,GAAGP,MAAM;IAAA;IACxCmB,WAAU,EAAApB,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAA,OAAEd,MAAA,CAAAsB,SAAS,GAAGR,MAAM;IAAA;IAC9BoB,cAAa,EAAArB,MAAA,QAAAA,MAAA,gBAAAC,MAAA;MAAad,MAAA,CAAAqB,cAAc;MAAmBrB,MAAA,CAAAsB,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}