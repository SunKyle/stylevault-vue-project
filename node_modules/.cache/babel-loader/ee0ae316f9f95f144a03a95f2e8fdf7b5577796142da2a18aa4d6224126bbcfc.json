{"ast":null,"code":"import { defineStore } from 'pinia';\nimport { outfitService } from '../services/outfitService';\nexport const useOutfitStore = defineStore('outfit', {\n  state: () => ({\n    outfits: [],\n    selectedOutfit: null,\n    loading: false,\n    error: null\n  }),\n  getters: {\n    // 获取所有搭配\n    allOutfits: state => state.outfits,\n    // 获取收藏的搭配\n    favoriteOutfits: state => state.outfits.filter(outfit => outfit.liked),\n    // 按标签获取搭配\n    outfitsByTag: state => tag => {\n      return state.outfits.filter(outfit => outfit.tag === tag);\n    },\n    // 按场合获取搭配\n    outfitsByOccasion: state => occasion => {\n      return state.outfits.filter(outfit => outfit.occasion === occasion);\n    },\n    // 获取最热门的搭配\n    popularOutfits: state => {\n      return [...state.outfits].sort((a, b) => b.likes - a.likes).slice(0, 5);\n    }\n  },\n  actions: {\n    // 设置加载状态\n    setLoading(status) {\n      this.loading = status;\n    },\n    // 设置错误信息\n    setError(error) {\n      this.error = error;\n    },\n    // 清除错误信息\n    clearError() {\n      this.error = null;\n    },\n    // 获取所有搭配\n    async fetchOutfits() {\n      this.setLoading(true);\n      this.clearError();\n      try {\n        const outfits = await outfitService.getOutfits();\n        this.outfits = outfits;\n        return outfits;\n      } catch (error) {\n        this.setError('获取搭配列表失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n    // 根据标签获取搭配\n    async fetchOutfitsByTag(tag) {\n      this.setLoading(true);\n      this.clearError();\n      try {\n        const outfits = await outfitService.getOutfitsByTag(tag);\n        return outfits;\n      } catch (error) {\n        this.setError(`获取标签为\"${tag}\"的搭配失败`);\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n    // 添加新搭配\n    async addOutfit(outfit) {\n      this.setLoading(true);\n      this.clearError();\n      try {\n        const newOutfit = await outfitService.addOutfit(outfit);\n        this.outfits.push(newOutfit);\n        return newOutfit;\n      } catch (error) {\n        this.setError('添加搭配失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n    // 删除搭配\n    async removeOutfit(outfitTitle) {\n      this.setLoading(true);\n      this.clearError();\n      try {\n        const removedOutfit = await outfitService.deleteOutfit(outfitTitle);\n        if (removedOutfit) {\n          this.outfits = this.outfits.filter(outfit => outfit.title !== outfitTitle);\n        }\n        return removedOutfit;\n      } catch (error) {\n        this.setError('删除搭配失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n    // 切换搭配的喜欢状态\n    async toggleLike(outfitTitle) {\n      this.setLoading(true);\n      this.clearError();\n      try {\n        const updatedOutfit = await outfitService.toggleLike(outfitTitle);\n        if (updatedOutfit) {\n          const index = this.outfits.findIndex(outfit => outfit.title === outfitTitle);\n          if (index !== -1) {\n            // 使用splice替换数组中的元素，确保Vue能够检测到变化\n            this.outfits.splice(index, 1, updatedOutfit);\n          }\n        }\n        return updatedOutfit;\n      } catch (error) {\n        this.setError('切换喜欢状态失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n    // 设置选中的搭配\n    setSelectedOutfit(outfit) {\n      this.selectedOutfit = outfit;\n    },\n    // 清除选中的搭配\n    clearSelectedOutfit() {\n      this.selectedOutfit = null;\n    },\n    // 初始化搭配数据\n    async initializeData() {\n      this.setLoading(true);\n      this.clearError();\n      try {\n        await this.fetchOutfits();\n      } catch (error) {\n        console.error('初始化搭配数据失败:', error);\n        this.setError('初始化搭配数据失败，请重试');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    }\n  }\n});","map":{"version":3,"names":["defineStore","outfitService","useOutfitStore","state","outfits","selectedOutfit","loading","error","getters","allOutfits","favoriteOutfits","filter","outfit","liked","outfitsByTag","tag","outfitsByOccasion","occasion","popularOutfits","sort","a","b","likes","slice","actions","setLoading","status","setError","clearError","fetchOutfits","getOutfits","fetchOutfitsByTag","getOutfitsByTag","addOutfit","newOutfit","push","removeOutfit","outfitTitle","removedOutfit","deleteOutfit","title","toggleLike","updatedOutfit","index","findIndex","splice","setSelectedOutfit","clearSelectedOutfit","initializeData","console"],"sources":["/Users/sunxiaokai/Desktop/stylevault-vue-project/src/stores/outfitStore.js"],"sourcesContent":["import { defineStore } from 'pinia';\nimport { outfitService } from '../services/outfitService';\n\nexport const useOutfitStore = defineStore('outfit', {\n  state: () => ({\n    outfits: [],\n    selectedOutfit: null,\n    loading: false,\n    error: null,\n  }),\n\n  getters: {\n    // 获取所有搭配\n    allOutfits: state => state.outfits,\n\n    // 获取收藏的搭配\n    favoriteOutfits: state => state.outfits.filter(outfit => outfit.liked),\n\n    // 按标签获取搭配\n    outfitsByTag: state => tag => {\n      return state.outfits.filter(outfit => outfit.tag === tag);\n    },\n\n    // 按场合获取搭配\n    outfitsByOccasion: state => occasion => {\n      return state.outfits.filter(outfit => outfit.occasion === occasion);\n    },\n\n    // 获取最热门的搭配\n    popularOutfits: state => {\n      return [...state.outfits].sort((a, b) => b.likes - a.likes).slice(0, 5);\n    },\n  },\n\n  actions: {\n    // 设置加载状态\n    setLoading(status) {\n      this.loading = status;\n    },\n\n    // 设置错误信息\n    setError(error) {\n      this.error = error;\n    },\n\n    // 清除错误信息\n    clearError() {\n      this.error = null;\n    },\n\n    // 获取所有搭配\n    async fetchOutfits() {\n      this.setLoading(true);\n      this.clearError();\n\n      try {\n        const outfits = await outfitService.getOutfits();\n        this.outfits = outfits;\n        return outfits;\n      } catch (error) {\n        this.setError('获取搭配列表失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n\n    // 根据标签获取搭配\n    async fetchOutfitsByTag(tag) {\n      this.setLoading(true);\n      this.clearError();\n\n      try {\n        const outfits = await outfitService.getOutfitsByTag(tag);\n        return outfits;\n      } catch (error) {\n        this.setError(`获取标签为\"${tag}\"的搭配失败`);\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n\n    // 添加新搭配\n    async addOutfit(outfit) {\n      this.setLoading(true);\n      this.clearError();\n\n      try {\n        const newOutfit = await outfitService.addOutfit(outfit);\n        this.outfits.push(newOutfit);\n        return newOutfit;\n      } catch (error) {\n        this.setError('添加搭配失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n\n    // 删除搭配\n    async removeOutfit(outfitTitle) {\n      this.setLoading(true);\n      this.clearError();\n\n      try {\n        const removedOutfit = await outfitService.deleteOutfit(outfitTitle);\n        if (removedOutfit) {\n          this.outfits = this.outfits.filter(outfit => outfit.title !== outfitTitle);\n        }\n        return removedOutfit;\n      } catch (error) {\n        this.setError('删除搭配失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n\n    // 切换搭配的喜欢状态\n    async toggleLike(outfitTitle) {\n      this.setLoading(true);\n      this.clearError();\n\n      try {\n        const updatedOutfit = await outfitService.toggleLike(outfitTitle);\n        if (updatedOutfit) {\n          const index = this.outfits.findIndex(outfit => outfit.title === outfitTitle);\n          if (index !== -1) {\n            // 使用splice替换数组中的元素，确保Vue能够检测到变化\n            this.outfits.splice(index, 1, updatedOutfit);\n          }\n        }\n        return updatedOutfit;\n      } catch (error) {\n        this.setError('切换喜欢状态失败');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n\n    // 设置选中的搭配\n    setSelectedOutfit(outfit) {\n      this.selectedOutfit = outfit;\n    },\n\n    // 清除选中的搭配\n    clearSelectedOutfit() {\n      this.selectedOutfit = null;\n    },\n\n    // 初始化搭配数据\n    async initializeData() {\n      this.setLoading(true);\n      this.clearError();\n\n      try {\n        await this.fetchOutfits();\n      } catch (error) {\n        console.error('初始化搭配数据失败:', error);\n        this.setError('初始化搭配数据失败，请重试');\n        throw error;\n      } finally {\n        this.setLoading(false);\n      }\n    },\n  },\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}