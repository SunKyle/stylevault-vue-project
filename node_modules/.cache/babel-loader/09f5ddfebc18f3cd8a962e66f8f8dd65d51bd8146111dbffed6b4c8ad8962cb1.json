{"ast":null,"code":"function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, vModelCheckbox as _vModelCheckbox, withModifiers as _withModifiers, Transition as _Transition, withCtx as _withCtx } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"bg-gradient-to-r from-primary to-secondary p-5 text-white\"\n};\nvar _hoisted_2 = {\n  \"class\": \"flex items-center justify-between\"\n};\nvar _hoisted_3 = {\n  \"class\": \"p-5\"\n};\nvar _hoisted_4 = {\n  \"class\": \"mb-6\"\n};\nvar _hoisted_5 = {\n  \"class\": \"flex items-center space-x-4\"\n};\nvar _hoisted_6 = {\n  \"class\": \"relative\"\n};\nvar _hoisted_7 = {\n  \"class\": \"w-24 h-24 rounded-lg overflow-hidden bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center\"\n};\nvar _hoisted_8 = [\"src\", \"alt\"];\nvar _hoisted_9 = {\n  \"class\": \"space-y-4\"\n};\nvar _hoisted_10 = [\"value\"];\nvar _hoisted_11 = {\n  key: 0,\n  \"class\": \"text-xs text-yellow-600 mt-1\"\n};\nvar _hoisted_12 = {\n  \"class\": \"flex items-center\"\n};\nvar _hoisted_13 = {\n  \"class\": \"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200\"\n};\nvar _hoisted_14 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_font_awesome_icon = _resolveComponent(\"font-awesome-icon\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" 编辑衣物模态框 \"), _createVNode(_Transition, {\n    name: \"fade\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [$props.isOpen ? (_openBlock(), _createElementBlock(\"div\", {\n        key: 0,\n        \"class\": \"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\",\n        onClick: _cache[15] || (_cache[15] = function () {\n          return $setup.closeOnBackdrop && $setup.closeOnBackdrop.apply($setup, arguments);\n        })\n      }, [_createElementVNode(\"div\", {\n        \"class\": \"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\",\n        onClick: _cache[14] || (_cache[14] = _withModifiers(function () {}, [\"stop\"]))\n      }, [_createCommentVNode(\" 头部 \"), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[16] || (_cache[16] = _createElementVNode(\"h2\", {\n        \"class\": \"text-xl font-bold\"\n      }, \"编辑衣物\", -1 /* CACHED */)), _createElementVNode(\"button\", {\n        onClick: _cache[0] || (_cache[0] = function ($event) {\n          return _ctx.$emit('close');\n        }),\n        \"class\": \"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors\"\n      }, [_createVNode(_component_font_awesome_icon, {\n        icon: ['fas', 'times']\n      })])])]), _createCommentVNode(\" 表单内容 \"), _createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" 图片上传区域 \"), _createElementVNode(\"div\", _hoisted_4, [_cache[18] || (_cache[18] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-2\"\n      }, \"衣物图片\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [$setup.form.image ? (_openBlock(), _createElementBlock(\"img\", {\n        key: 0,\n        src: $setup.form.image,\n        alt: $setup.form.name,\n        \"class\": \"w-full h-full object-cover\"\n      }, null, 8 /* PROPS */, _hoisted_8)) : (_openBlock(), _createBlock(_component_font_awesome_icon, {\n        key: 1,\n        icon: ['fas', 'image'],\n        \"class\": \"text-gray-400 text-2xl\"\n      }))]), $setup.form.image ? (_openBlock(), _createElementBlock(\"button\", {\n        key: 0,\n        onClick: _cache[1] || (_cache[1] = function ($event) {\n          return $setup.form.image = '';\n        }),\n        \"class\": \"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-red-500 text-white flex items-center justify-center\"\n      }, [_createVNode(_component_font_awesome_icon, {\n        icon: ['fas', 'times'],\n        \"class\": \"text-xs\"\n      })])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", null, [_createElementVNode(\"button\", {\n        onClick: _cache[2] || (_cache[2] = function () {\n          return $setup.triggerFileInput && $setup.triggerFileInput.apply($setup, arguments);\n        }),\n        \"class\": \"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors\"\n      }, \" 上传图片 \"), _createElementVNode(\"input\", {\n        ref: \"fileInput\",\n        type: \"file\",\n        accept: \"image/*\",\n        \"class\": \"hidden\",\n        onChange: _cache[3] || (_cache[3] = function () {\n          return $setup.handleImageUpload && $setup.handleImageUpload.apply($setup, arguments);\n        })\n      }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), _cache[17] || (_cache[17] = _createElementVNode(\"p\", {\n        \"class\": \"text-xs text-gray-500 mt-1\"\n      }, \"支持 JPG, PNG 格式\", -1 /* CACHED */))])])]), _createCommentVNode(\" 基本信息 \"), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", null, [_cache[19] || (_cache[19] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-1\"\n      }, [_createTextVNode(\"衣物名称 \"), _createElementVNode(\"span\", {\n        \"class\": \"text-red-500\"\n      }, \"*\")], -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n          return $setup.form.name = $event;\n        }),\n        type: \"text\",\n        \"class\": \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\",\n        placeholder: \"请输入衣物名称\",\n        required: \"\"\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.name]])]), _createElementVNode(\"div\", null, [_cache[20] || (_cache[20] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-1\"\n      }, \"品牌\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = function ($event) {\n          return $setup.form.brand = $event;\n        }),\n        type: \"text\",\n        \"class\": \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\",\n        placeholder: \"请输入品牌名称\"\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.brand]])]), _createElementVNode(\"div\", null, [_cache[22] || (_cache[22] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-1\"\n      }, [_createTextVNode(\"分类 \"), _createElementVNode(\"span\", {\n        \"class\": \"text-red-500\"\n      }, \"*\")], -1 /* CACHED */)), _withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = function ($event) {\n          return $setup.form.categoryId = $event;\n        }),\n        \"class\": \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\",\n        required: \"\",\n        onChange: _cache[7] || (_cache[7] = function () {\n          return _ctx.updateCategoryName && _ctx.updateCategoryName.apply(_ctx, arguments);\n        })\n      }, [_cache[21] || (_cache[21] = _createElementVNode(\"option\", {\n        value: \"\"\n      }, \"请选择分类\", -1 /* CACHED */)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.categories, function (category) {\n        return _openBlock(), _createElementBlock(\"option\", {\n          key: category.id,\n          value: category.id\n        }, _toDisplayString(category.name), 9 /* TEXT, PROPS */, _hoisted_10);\n      }), 128 /* KEYED_FRAGMENT */))], 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelSelect, $setup.form.categoryId]]), $setup.form.categoryId && !$setup.categories.find(function (c) {\n        return c.id === $setup.form.categoryId;\n      }) ? (_openBlock(), _createElementBlock(\"p\", _hoisted_11, \" 当前衣物分类已不存在，请重新选择 \")) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", null, [_cache[23] || (_cache[23] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-1\"\n      }, \"颜色\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[8] || (_cache[8] = function ($event) {\n          return $setup.form.color = $event;\n        }),\n        type: \"text\",\n        \"class\": \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\",\n        placeholder: \"例如：蓝色、黑色\"\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.color]])]), _createElementVNode(\"div\", null, [_cache[25] || (_cache[25] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-1\"\n      }, \"适用季节\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[9] || (_cache[9] = function ($event) {\n          return $setup.form.season = $event;\n        }),\n        \"class\": \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n      }, _toConsumableArray(_cache[24] || (_cache[24] = [_createElementVNode(\"option\", {\n        value: \"\"\n      }, \"请选择季节\", -1 /* CACHED */), _createElementVNode(\"option\", {\n        value: \"春季\"\n      }, \"春季\", -1 /* CACHED */), _createElementVNode(\"option\", {\n        value: \"夏季\"\n      }, \"夏季\", -1 /* CACHED */), _createElementVNode(\"option\", {\n        value: \"秋季\"\n      }, \"秋季\", -1 /* CACHED */), _createElementVNode(\"option\", {\n        value: \"冬季\"\n      }, \"冬季\", -1 /* CACHED */), _createElementVNode(\"option\", {\n        value: \"四季\"\n      }, \"四季\", -1 /* CACHED */)])), 512 /* NEED_PATCH */), [[_vModelSelect, $setup.form.season]])]), _createElementVNode(\"div\", _hoisted_12, [_withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[10] || (_cache[10] = function ($event) {\n          return $setup.form.favorite = $event;\n        }),\n        type: \"checkbox\",\n        id: \"favorite\",\n        \"class\": \"w-4 h-4 text-primary focus:ring-primary border-gray-300 rounded\"\n      }, null, 512 /* NEED_PATCH */), [[_vModelCheckbox, $setup.form.favorite]]), _cache[26] || (_cache[26] = _createElementVNode(\"label\", {\n        \"for\": \"favorite\",\n        \"class\": \"ml-2 block text-sm text-gray-700\"\n      }, \"添加到收藏\", -1 /* CACHED */))]), _createElementVNode(\"div\", null, [_cache[27] || (_cache[27] = _createElementVNode(\"label\", {\n        \"class\": \"block text-sm font-medium text-gray-700 mb-1\"\n      }, \"备注\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"textarea\", {\n        \"onUpdate:modelValue\": _cache[11] || (_cache[11] = function ($event) {\n          return $setup.form.notes = $event;\n        }),\n        rows: \"3\",\n        \"class\": \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\",\n        placeholder: \"添加备注信息（可选）\"\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.notes]])])]), _createCommentVNode(\" 操作按钮 \"), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"button\", {\n        onClick: _cache[12] || (_cache[12] = function ($event) {\n          return _ctx.$emit('close');\n        }),\n        \"class\": \"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors\"\n      }, \" 取消 \"), _createElementVNode(\"button\", {\n        onClick: _cache[13] || (_cache[13] = function () {\n          return $setup.saveItem && $setup.saveItem.apply($setup, arguments);\n        }),\n        disabled: !$setup.isFormValid,\n        \"class\": \"px-4 py-2 bg-primary text-white rounded-lg font-medium hover:bg-primary-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n      }, \" 保存 \", 8 /* PROPS */, _hoisted_14)])])])])) : _createCommentVNode(\"v-if\", true)];\n    }),\n    _: 1 /* STABLE */\n  })], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */);\n}","map":{"version":3,"names":["_createCommentVNode","_createVNode","_Transition","name","$props","isOpen","_createElementBlock","onClick","_cache","$setup","closeOnBackdrop","apply","arguments","_createElementVNode","_withModifiers","_hoisted_1","_hoisted_2","$event","_ctx","$emit","_component_font_awesome_icon","icon","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","form","image","src","alt","_createBlock","triggerFileInput","ref","type","accept","onChange","handleImageUpload","_hoisted_9","placeholder","required","brand","categoryId","updateCategoryName","value","_Fragment","_renderList","categories","category","key","id","_hoisted_10","find","c","_hoisted_11","color","season","_hoisted_12","favorite","notes","rows","_hoisted_13","saveItem","disabled","isFormValid","_hoisted_14"],"sources":["/Users/sunxiaokai/Desktop/stylevault-vue-project/src/components/features/wardrobe/ClothingItemEditor.vue"],"sourcesContent":["<template>\n  <!-- 编辑衣物模态框 -->\n  <transition name=\"fade\">\n    <div v-if=\"isOpen\" class=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\" @click=\"closeOnBackdrop\">\n      <div class=\"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\" @click.stop>\n        <!-- 头部 -->\n        <div class=\"bg-gradient-to-r from-primary to-secondary p-5 text-white\">\n          <div class=\"flex items-center justify-between\">\n            <h2 class=\"text-xl font-bold\">编辑衣物</h2>\n            <button @click=\"$emit('close')\" class=\"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors\">\n              <font-awesome-icon :icon=\"['fas', 'times']\" />\n            </button>\n          </div>\n        </div>\n\n        <!-- 表单内容 -->\n        <div class=\"p-5\">\n          <!-- 图片上传区域 -->\n          <div class=\"mb-6\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">衣物图片</label>\n            <div class=\"flex items-center space-x-4\">\n              <div class=\"relative\">\n                <div class=\"w-24 h-24 rounded-lg overflow-hidden bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center\">\n                  <img v-if=\"form.image\" :src=\"form.image\" :alt=\"form.name\" class=\"w-full h-full object-cover\" />\n                  <font-awesome-icon v-else :icon=\"['fas', 'image']\" class=\"text-gray-400 text-2xl\" />\n                </div>\n                <button v-if=\"form.image\" @click=\"form.image = ''\" class=\"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-red-500 text-white flex items-center justify-center\">\n                  <font-awesome-icon :icon=\"['fas', 'times']\" class=\"text-xs\" />\n                </button>\n              </div>\n              <div>\n                <button @click=\"triggerFileInput\" class=\"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors\">\n                  上传图片\n                </button>\n                <input ref=\"fileInput\" type=\"file\" accept=\"image/*\" class=\"hidden\" @change=\"handleImageUpload\" />\n                <p class=\"text-xs text-gray-500 mt-1\">支持 JPG, PNG 格式</p>\n              </div>\n            </div>\n          </div>\n\n          <!-- 基本信息 -->\n          <div class=\"space-y-4\">\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">衣物名称 <span class=\"text-red-500\">*</span></label>\n              <input \n                v-model=\"form.name\" \n                type=\"text\" \n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n                placeholder=\"请输入衣物名称\"\n                required\n              />\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">品牌</label>\n              <input \n                v-model=\"form.brand\" \n                type=\"text\" \n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n                placeholder=\"请输入品牌名称\"\n              />\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">分类 <span class=\"text-red-500\">*</span></label>\n              <select \n                v-model=\"form.categoryId\" \n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n                required\n                @change=\"updateCategoryName\"\n              >\n                <option value=\"\">请选择分类</option>\n                <option v-for=\"category in categories\" :key=\"category.id\" :value=\"category.id\">\n                  {{ category.name }}\n                </option>\n              </select>\n              <p v-if=\"form.categoryId && !categories.find(c => c.id === form.categoryId)\" class=\"text-xs text-yellow-600 mt-1\">\n                当前衣物分类已不存在，请重新选择\n              </p>\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">颜色</label>\n              <input \n                v-model=\"form.color\" \n                type=\"text\" \n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n                placeholder=\"例如：蓝色、黑色\"\n              />\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">适用季节</label>\n              <select \n                v-model=\"form.season\" \n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n              >\n                <option value=\"\">请选择季节</option>\n                <option value=\"春季\">春季</option>\n                <option value=\"夏季\">夏季</option>\n                <option value=\"秋季\">秋季</option>\n                <option value=\"冬季\">冬季</option>\n                <option value=\"四季\">四季</option>\n              </select>\n            </div>\n\n            <div class=\"flex items-center\">\n              <input \n                v-model=\"form.favorite\" \n                type=\"checkbox\" \n                id=\"favorite\"\n                class=\"w-4 h-4 text-primary focus:ring-primary border-gray-300 rounded\"\n              />\n              <label for=\"favorite\" class=\"ml-2 block text-sm text-gray-700\">添加到收藏</label>\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">备注</label>\n              <textarea \n                v-model=\"form.notes\" \n                rows=\"3\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary\"\n                placeholder=\"添加备注信息（可选）\"\n              ></textarea>\n            </div>\n          </div>\n\n          <!-- 操作按钮 -->\n          <div class=\"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200\">\n            <button \n              @click=\"$emit('close')\" \n              class=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors\"\n            >\n              取消\n            </button>\n            <button \n              @click=\"saveItem\" \n              :disabled=\"!isFormValid\"\n              class=\"px-4 py-2 bg-primary text-white rounded-lg font-medium hover:bg-primary-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              保存\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script>\nimport { ref, computed, watch } from 'vue'\nimport { useWardrobeStore } from '../../../stores/wardrobeStore'\nimport { showToast } from '../../../utils/toast'\n\nexport default {\n  name: 'ClothingItemEditor',\n  props: {\n    isOpen: {\n      type: Boolean,\n      required: true\n    },\n    item: {\n      type: Object,\n      default: null\n    }\n  },\n  emits: ['close', 'saved'],\n  setup(props, { emit }) {\n    const wardrobeStore = useWardrobeStore()\n    const fileInput = ref(null)\n\n    // 表单数据\n    const form = ref({\n      id: '',\n      name: '',\n      brand: '',\n      categoryId: '',\n      categoryName: '',\n      color: '',\n      season: '',\n      favorite: false,\n      image: '',\n      notes: ''\n    })\n\n    // 分类数据\n    const categories = computed(() => wardrobeStore.categories)\n\n    // 表单验证\n    const isFormValid = computed(() => {\n      return form.value.name.trim() !== '' && form.value.category !== ''\n    })\n\n    // 监听props.item变化，更新表单\n    watch(() => props.item, (newItem) => {\n      if (newItem) {\n        // 深拷贝避免直接修改原始对象\n        const itemCopy = { ...newItem }\n        \n        // 确保分类信息正确传递\n        // 如果item中有categoryName但没有categoryId，尝试匹配\n        if (!itemCopy.categoryId && itemCopy.categoryName) {\n          const matchedCategory = categories.value.find(c => c.name === itemCopy.categoryName)\n          if (matchedCategory) {\n            itemCopy.categoryId = matchedCategory.id\n          }\n        }\n        \n        // 如果item中有categoryId但没有categoryName，尝试设置categoryName\n        if (itemCopy.categoryId && !itemCopy.categoryName) {\n          const matchedCategory = categories.value.find(c => c.id === itemCopy.categoryId)\n          if (matchedCategory) {\n            itemCopy.categoryName = matchedCategory.name\n          }\n        }\n        \n        // 兼容旧数据中的category字段\n        if (!itemCopy.categoryId && itemCopy.category) {\n          // 如果有category字段但没有categoryId，尝试匹配\n          const matchedCategory = categories.value.find(c => c.id === itemCopy.category || c.name === itemCopy.category)\n          if (matchedCategory) {\n            itemCopy.categoryId = matchedCategory.id\n            itemCopy.categoryName = matchedCategory.name\n          }\n        }\n        \n        form.value = itemCopy\n      } else {\n        // 重置表单\n        resetForm()\n      }\n    }, { immediate: true })\n\n    // 重置表单\n    function resetForm() {\n      form.value = {\n        id: '',\n        name: '',\n        brand: '',\n        categoryId: '',\n        categoryName: '',\n        color: '',\n        season: '',\n        favorite: false,\n        image: '',\n        notes: ''\n      }\n    }\n\n    // 触发文件选择\n    function triggerFileInput() {\n      fileInput.value.click()\n    }\n\n    // 处理图片上传\n    function handleImageUpload(event) {\n      const file = event.target.files[0]\n      if (file) {\n        // 在实际应用中，这里应该上传到服务器\n        // 这里简化处理，使用FileReader读取为DataURL\n        const reader = new FileReader()\n        reader.onload = (e) => {\n          form.value.image = e.target.result\n        }\n        reader.readAsDataURL(file)\n      }\n    }\n    \n    // 更新分类名称\n    function updateCategoryName() {\n      if (form.value.categoryId) {\n        const selectedCategory = categories.value.find(c => c.id === form.value.categoryId)\n        if (selectedCategory) {\n          form.value.categoryName = selectedCategory.name\n        }\n      } else {\n        form.value.categoryName = ''\n      }\n    }\n\n    // 保存衣物\n    async function saveItem() {\n      if (!isFormValid.value) return\n\n      try {\n        if (form.value.id) {\n          // 更新现有衣物\n          await wardrobeStore.updateClothingItem(form.value.id, form.value)\n          showToast('衣物信息已更新', 'success')\n        } else {\n          // 添加新衣物\n          await wardrobeStore.addClothingItem(form.value)\n          showToast('新衣物已添加', 'success')\n        }\n\n        // 通知父组件保存成功\n        emit('saved')\n        // 关闭模态框\n        emit('close')\n      } catch (error) {\n        showToast('保存失败，请重试', 'error')\n        console.error('保存衣物失败:', error)\n      }\n    }\n\n    // 点击背景关闭\n    function closeOnBackdrop() {\n      emit('close')\n    }\n\n    return {\n      form,\n      categories,\n      isFormValid,\n      fileInput,\n      triggerFileInput,\n      handleImageUpload,\n      saveItem,\n      closeOnBackdrop\n    }\n  }\n}\n</script>\n\n<style scoped>\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}