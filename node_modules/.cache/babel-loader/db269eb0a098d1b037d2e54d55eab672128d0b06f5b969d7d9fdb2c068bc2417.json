{"ast":null,"code":"function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nimport { createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, toDisplayString as _toDisplayString, Fragment as _Fragment, withModifiers as _withModifiers, renderList as _renderList, createBlock as _createBlock, withCtx as _withCtx } from \"vue\";\nvar _hoisted_1 = {\n  key: 0,\n  \"class\": \"container mx-auto px-4 mb-12\"\n};\nvar _hoisted_2 = {\n  \"class\": \"container mx-auto px-4 mb-12\"\n};\nvar _hoisted_3 = {\n  \"class\": \"bg-red-50 border border-red-200 rounded-xl p-6 text-center\"\n};\nvar _hoisted_4 = {\n  \"class\": \"text-red-600 mb-4\"\n};\nvar _hoisted_5 = {\n  \"class\": \"container mx-auto px-4 mb-12\"\n};\nvar _hoisted_6 = {\n  \"class\": \"flex items-center justify-between mb-6\"\n};\nvar _hoisted_7 = {\n  \"class\": \"grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3 sm:gap-4\"\n};\nvar _hoisted_8 = {\n  key: 4,\n  \"class\": \"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-8 gap-4\"\n};\nvar _hoisted_9 = {\n  key: 5,\n  \"class\": \"container mx-auto px-4\"\n};\nvar _hoisted_10 = {\n  \"class\": \"flex items-center justify-between mb-6\"\n};\nvar _hoisted_11 = {\n  href: \"#\",\n  \"class\": \"text-primary font-medium flex items-center group\"\n};\nvar _hoisted_12 = {\n  \"class\": \"grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4 sm:gap-5\"\n};\nvar _hoisted_13 = {\n  \"class\": \"group relative\"\n};\nvar _hoisted_14 = {\n  \"class\": \"aspect-square bg-white rounded-xl overflow-hidden shadow-soft hover:shadow-medium transition-all duration-300 mb-3 border-2 border-dashed border-neutral-200 flex items-center justify-center\"\n};\nvar _hoisted_15 = {\n  \"class\": \"text-center p-6 group-hover:scale-110 transition-transform\"\n};\nvar _hoisted_16 = {\n  \"class\": \"w-14 h-14 mx-auto bg-neutral-100 rounded-full flex items-center justify-center mb-3\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_font_awesome_icon = _resolveComponent(\"font-awesome-icon\");\n  return _openBlock(), _createBlock($setup[\"ContentLayout\"], null, {\n    \"default\": _withCtx(function () {\n      return [(_openBlock(), _createElementBlock(\"section\", {\n        key: $setup.forceUpdateKey\n      }, [_createCommentVNode(\" 搜索和上传区 \"), _createVNode($setup[\"WardrobeHeader\"], {\n        handleSearch: $setup.handleSearch,\n        onShowUpload: _cache[0] || (_cache[0] = function ($event) {\n          return _ctx.$emit('showUpload');\n        }),\n        onViewAll: $setup.viewAllCategories\n      }), _createCommentVNode(\" 加载状态 \"), $setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, _toConsumableArray(_cache[2] || (_cache[2] = [_createElementVNode(\"div\", {\n        \"class\": \"flex justify-center items-center h-64\"\n      }, [_createElementVNode(\"div\", {\n        \"class\": \"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary\"\n      })], -1 /* CACHED */)])))) : $setup.error ? (_openBlock(), _createElementBlock(_Fragment, {\n        key: 1\n      }, [_createCommentVNode(\" 错误状态 \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_font_awesome_icon, {\n        icon: ['fas', 'exclamation-circle'],\n        \"class\": \"text-red-500 text-3xl mb-3\"\n      }), _cache[3] || (_cache[3] = _createElementVNode(\"h3\", {\n        \"class\": \"text-lg font-medium text-red-800 mb-2\"\n      }, \"加载失败\", -1 /* CACHED */)), _createElementVNode(\"p\", _hoisted_4, _toDisplayString($setup.error), 1 /* TEXT */), _createElementVNode(\"button\", {\n        onClick: $setup.initializeData,\n        \"class\": \"bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-6 rounded-lg transition-colors\"\n      }, \" 重试 \")])])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n        key: 2\n      }, [_createCommentVNode(\" 衣物分类 \"), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_cache[5] || (_cache[5] = _createElementVNode(\"h3\", {\n        \"class\": \"text-xl md:text-2xl font-bold\"\n      }, \"衣物分类\", -1 /* CACHED */)), _createElementVNode(\"a\", {\n        href: \"#\",\n        onClick: _withModifiers($setup.viewAllCategories, [\"prevent\"]),\n        \"class\": \"text-primary font-medium flex items-center group\"\n      }, [_cache[4] || (_cache[4] = _createElementVNode(\"span\", null, \"查看全部\", -1 /* CACHED */)), _createVNode(_component_font_awesome_icon, {\n        icon: ['fas', 'arrow-right'],\n        \"class\": \"ml-1 text-sm group-hover:translate-x-1 transition-transform\"\n      })])]), _createElementVNode(\"div\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.categories, function (category) {\n        return _openBlock(), _createBlock($setup[\"ClothingCategory\"], {\n          key: category.id,\n          category: category,\n          count: $setup.getCategoryItemCount(category.id),\n          onClick: function onClick($event) {\n            return $setup.selectCategory(category.id);\n          },\n          selected: $setup.selectedCategory === category.id\n        }, null, 8 /* PROPS */, [\"category\", \"count\", \"onClick\", \"selected\"]);\n      }), 128 /* KEYED_FRAGMENT */))])])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)), _createCommentVNode(\" 我的收藏 \"), _createVNode($setup[\"FavoriteSection\"]), _createCommentVNode(\" 精选搭配 \"), !$setup.loading && !$setup.error ? (_openBlock(), _createBlock($setup[\"FeaturedOutfits\"], {\n        key: 3,\n        outfits: $setup.outfits\n      }, null, 8 /* PROPS */, [\"outfits\"])) : _createCommentVNode(\"v-if\", true), $setup.getCategoryItems($setup.selectedCategory).length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.getCategoryItems($setup.selectedCategory), function (item) {\n        return _openBlock(), _createBlock($setup[\"ClothingItem\"], {\n          key: item.id,\n          item: item,\n          onLike: function onLike($event) {\n            return $setup.toggleFavorite(item);\n          },\n          onViewDetail: $setup.viewItemDetail,\n          \"class\": \"transform transition-transform hover:scale-105\"\n        }, null, 8 /* PROPS */, [\"item\", \"onLike\"]);\n      }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 最近添加的衣物 \"), !$setup.loading && !$setup.error && !$setup.selectedCategory ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_cache[7] || (_cache[7] = _createElementVNode(\"h3\", {\n        \"class\": \"text-xl md:text-2xl font-bold\"\n      }, \"最近添加\", -1 /* CACHED */)), _createElementVNode(\"a\", _hoisted_11, [_cache[6] || (_cache[6] = _createElementVNode(\"span\", null, \"管理所有衣物\", -1 /* CACHED */)), _createVNode(_component_font_awesome_icon, {\n        icon: ['fas', 'arrow-right'],\n        \"class\": \"ml-1 text-sm group-hover:translate-x-1 transition-transform\"\n      })])]), _createElementVNode(\"div\", _hoisted_12, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.recentlyAddedItems, function (item) {\n        return _openBlock(), _createBlock($setup[\"ClothingItem\"], {\n          key: item.id,\n          item: item,\n          onLike: function onLike($event) {\n            return $setup.toggleFavorite(item);\n          }\n        }, null, 8 /* PROPS */, [\"item\", \"onLike\"]);\n      }), 128 /* KEYED_FRAGMENT */)), _createCommentVNode(\" 添加更多 \"), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"div\", _hoisted_16, [_createVNode(_component_font_awesome_icon, {\n        icon: ['fas', 'plus'],\n        \"class\": \"text-neutral-400 text-xl\"\n      })]), _cache[8] || (_cache[8] = _createElementVNode(\"p\", {\n        \"class\": \"text-neutral-500 font-medium\"\n      }, \"添加更多衣物\", -1 /* CACHED */))])])])])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 分类结果展示 \"), (_openBlock(), _createBlock($setup[\"CategoryDrawer\"], {\n        isDrawerOpen: $setup.isDrawerOpen,\n        isSearchMode: $setup.isSearchMode,\n        selectedCategory: $setup.selectedCategory,\n        getCategoryItems: $setup.getCategoryItems,\n        getSelectedCategoryName: $setup.getSelectedCategoryName,\n        getCategoryItemCount: $setup.getCategoryItemCount,\n        key: $setup.forceUpdateKey,\n        onCloseDrawer: $setup.closeDrawer,\n        onShowUpload: _cache[1] || (_cache[1] = function ($event) {\n          return _ctx.$emit('showUpload');\n        }),\n        onToggleFavorite: $setup.toggleFavorite,\n        onViewItemDetail: $setup.viewItemDetail,\n        onEditItem: $setup.editItem,\n        onDeleteItem: $setup.deleteItem,\n        onApplyFilter: $setup.handleFilter,\n        onApplySort: $setup.handleSort\n      }, null, 8 /* PROPS */, [\"isDrawerOpen\", \"isSearchMode\", \"selectedCategory\"])), _createCommentVNode(\" 衣物编辑器 \"), _createVNode($setup[\"ClothingItemEditor\"], {\n        isOpen: $setup.isEditorOpen,\n        item: $setup.editingItem,\n        readOnly: $setup.isReadOnlyMode,\n        onClose: $setup.closeEditor,\n        onSaved: $setup.handleEditSaved\n      }, null, 8 /* PROPS */, [\"isOpen\", \"item\", \"readOnly\"])]))];\n    }),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["href","_createBlock","$setup","_createElementBlock","key","forceUpdateKey","_createCommentVNode","_createVNode","handleSearch","onShowUpload","_cache","$event","_ctx","$emit","onViewAll","viewAllCategories","loading","_hoisted_1","_toConsumableArray","_createElementVNode","error","_Fragment","_hoisted_2","_hoisted_3","_component_font_awesome_icon","icon","_hoisted_4","_toDisplayString","onClick","initializeData","_hoisted_5","_hoisted_6","_withModifiers","_hoisted_7","_renderList","categories","category","id","count","getCategoryItemCount","selectCategory","selected","selectedCategory","outfits","getCategoryItems","length","_hoisted_8","item","onLike","toggleFavorite","onViewDetail","viewItemDetail","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","recentlyAddedItems","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","isDrawerOpen","isSearchMode","getSelectedCategoryName","onCloseDrawer","closeDrawer","onToggleFavorite","onViewItemDetail","onEditItem","editItem","onDeleteItem","deleteItem","onApplyFilter","handleFilter","onApplySort","handleSort","isOpen","isEditorOpen","editingItem","readOnly","isReadOnlyMode","onClose","closeEditor","onSaved","handleEditSaved"],"sources":["/Users/sunxiaokai/Desktop/stylevault-vue-project/src/views/WardrobeView.vue"],"sourcesContent":["<template>\n  <ContentLayout>\n    <section :key=\"forceUpdateKey\">\n      <!-- 搜索和上传区 -->\n      <WardrobeHeader\n        :handleSearch=\"handleSearch\"\n        @showUpload=\"$emit('showUpload')\"\n        @viewAll=\"viewAllCategories\"\n      />\n\n      <!-- 加载状态 -->\n      <div v-if=\"loading\" class=\"container mx-auto px-4 mb-12\">\n        <div class=\"flex justify-center items-center h-64\">\n          <div\n            class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary\"\n          ></div>\n        </div>\n      </div>\n\n      <!-- 错误状态 -->\n      <div v-else-if=\"error\" class=\"container mx-auto px-4 mb-12\">\n        <div class=\"bg-red-50 border border-red-200 rounded-xl p-6 text-center\">\n          <font-awesome-icon\n            :icon=\"['fas', 'exclamation-circle']\"\n            class=\"text-red-500 text-3xl mb-3\"\n          />\n          <h3 class=\"text-lg font-medium text-red-800 mb-2\">加载失败</h3>\n          <p class=\"text-red-600 mb-4\">{{ error }}</p>\n          <button\n            @click=\"initializeData\"\n            class=\"bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-6 rounded-lg transition-colors\"\n          >\n            重试\n          </button>\n        </div>\n      </div>\n\n      <!-- 衣物分类 -->\n      <div v-else class=\"container mx-auto px-4 mb-12\">\n        <div class=\"flex items-center justify-between mb-6\">\n          <h3 class=\"text-xl md:text-2xl font-bold\">衣物分类</h3>\n          <a\n            href=\"#\"\n            @click.prevent=\"viewAllCategories\"\n            class=\"text-primary font-medium flex items-center group\"\n          >\n            <span>查看全部</span>\n            <font-awesome-icon\n              :icon=\"['fas', 'arrow-right']\"\n              class=\"ml-1 text-sm group-hover:translate-x-1 transition-transform\"\n            />\n          </a>\n        </div>\n        <div\n          class=\"grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3 sm:gap-4\"\n        >\n          <ClothingCategory\n            v-for=\"category in categories\"\n            :key=\"category.id\"\n            :category=\"category\"\n            :count=\"getCategoryItemCount(category.id)\"\n            @click=\"selectCategory(category.id)\"\n            :selected=\"selectedCategory === category.id\"\n          />\n        </div>\n      </div>\n\n      <!-- 我的收藏 -->\n      <FavoriteSection />\n\n      <!-- 精选搭配 -->\n      <FeaturedOutfits v-if=\"!loading && !error\" :outfits=\"outfits\" />\n      <div\n        v-if=\"getCategoryItems(selectedCategory).length > 0\"\n        class=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-8 gap-4\"\n      >\n        <ClothingItem\n          v-for=\"item in getCategoryItems(selectedCategory)\"\n          :key=\"item.id\"\n          :item=\"item\"\n          @like=\"toggleFavorite(item)\"\n          @viewDetail=\"viewItemDetail\"\n          class=\"transform transition-transform hover:scale-105\"\n        />\n      </div>\n\n      <!-- 最近添加的衣物 -->\n      <div v-if=\"!loading && !error && !selectedCategory\" class=\"container mx-auto px-4\">\n        <div class=\"flex items-center justify-between mb-6\">\n          <h3 class=\"text-xl md:text-2xl font-bold\">最近添加</h3>\n          <a href=\"#\" class=\"text-primary font-medium flex items-center group\">\n            <span>管理所有衣物</span>\n            <font-awesome-icon\n              :icon=\"['fas', 'arrow-right']\"\n              class=\"ml-1 text-sm group-hover:translate-x-1 transition-transform\"\n            />\n          </a>\n        </div>\n        <div\n          class=\"grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4 sm:gap-5\"\n        >\n          <ClothingItem\n            v-for=\"item in recentlyAddedItems\"\n            :key=\"item.id\"\n            :item=\"item\"\n            @like=\"toggleFavorite(item)\"\n          />\n          <!-- 添加更多 -->\n          <div class=\"group relative\">\n            <div\n              class=\"aspect-square bg-white rounded-xl overflow-hidden shadow-soft hover:shadow-medium transition-all duration-300 mb-3 border-2 border-dashed border-neutral-200 flex items-center justify-center\"\n            >\n              <div class=\"text-center p-6 group-hover:scale-110 transition-transform\">\n                <div\n                  class=\"w-14 h-14 mx-auto bg-neutral-100 rounded-full flex items-center justify-center mb-3\"\n                >\n                  <font-awesome-icon :icon=\"['fas', 'plus']\" class=\"text-neutral-400 text-xl\" />\n                </div>\n                <p class=\"text-neutral-500 font-medium\">添加更多衣物</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <!-- 分类结果展示 -->\n      <CategoryDrawer\n        :isDrawerOpen=\"isDrawerOpen\"\n        :isSearchMode=\"isSearchMode\"\n        :selectedCategory=\"selectedCategory\"\n        :getCategoryItems=\"getCategoryItems\"\n        :getSelectedCategoryName=\"getSelectedCategoryName\"\n        :getCategoryItemCount=\"getCategoryItemCount\"\n        :key=\"forceUpdateKey\"\n        @closeDrawer=\"closeDrawer\"\n        @showUpload=\"$emit('showUpload')\"\n        @toggleFavorite=\"toggleFavorite\"\n        @viewItemDetail=\"viewItemDetail\"\n        @editItem=\"editItem\"\n        @deleteItem=\"deleteItem\"\n        @applyFilter=\"handleFilter\"\n        @applySort=\"handleSort\"\n      />\n\n      <!-- 衣物编辑器 -->\n      <ClothingItemEditor\n        :isOpen=\"isEditorOpen\"\n        :item=\"editingItem\"\n        :readOnly=\"isReadOnlyMode\"\n        @close=\"closeEditor\"\n        @saved=\"handleEditSaved\"\n      />\n    </section>\n  </ContentLayout>\n</template>\n\n<script setup>\n  import { ref, computed, onMounted, nextTick, onUnmounted } from 'vue';\n  import ClothingCategory from '../components/ui/ClothingCategory.vue';\n  import ClothingItem from '../components/ui/ClothingItem.vue';\n  import FavoriteSection from '../components/wardrobe/FavoriteSection.vue';\n  import FeaturedOutfits from '../components/wardrobe/FeaturedOutfits.vue';\n  import WardrobeHeader from '../components/wardrobe/WardrobeHeader.vue';\n  import CategoryDrawer from '../components/wardrobe/CategoryDrawer.vue';\n  import ClothingItemEditor from '../components/wardrobe/ClothingItemEditor.vue';\n  import ContentLayout from '../components/layout/ContentLayout.vue';\n  import { useClothingStore } from '../stores/index';\n  import { outfitService } from '../services/outfitService';\n  import { useRouter } from 'vue-router';\n  import { showToast } from '../utils/toast';\n\n  const router = useRouter();\n  const clothingStore = useClothingStore();\n  const emit = defineEmits(['showUpload']);\n\n  // 状态\n  const isDrawerOpen = ref(false);\n  const searchResults = ref([]);\n  const isSearchMode = ref(false);\n  const currentSearchKeyword = ref('');\n  const currentFilter = ref('all');\n  const currentSort = ref(null);\n  const editingItem = ref(null);\n  const isEditorOpen = ref(false);\n  const isReadOnlyMode = ref(false);\n\n  // 计算属性\n  const categories = computed(() => clothingStore.categories);\n  const selectedCategory = computed(() => clothingStore.selectedCategory);\n  const loading = computed(() => clothingStore.loading);\n  const error = computed(() => clothingStore.error);\n  const recentlyAddedItems = computed(() => clothingStore.recentlyAddedItems);\n  const favoriteItems = computed(() => clothingStore.favoriteItems);\n\n  // 精选搭配数据\n  const outfits = ref([]);\n\n  // 获取搭配数据\n  const fetchOutfits = async () => {\n    try {\n      const response = await outfitService.getOutfits();\n      outfits.value = response.data || [];\n    } catch (error) {\n      console.error('获取搭配数据失败:', error);\n      outfits.value = [];\n    }\n  };\n\n  function getCategoryItemCount(categoryId) {\n    if (isSearchMode.value) return searchResults.value.length;\n    if (categoryId === 'all') return clothingStore.clothingItems.length;\n    return clothingStore.itemsByCategory[categoryId]?.length || 0;\n  }\n\n  function getSelectedCategoryName() {\n    if (isSearchMode.value) return `搜索结果: \"${currentSearchKeyword.value}\"`;\n    if (!selectedCategory.value) return '';\n    if (selectedCategory.value === 'all') return '全部衣物';\n    const category = categories.value.find(c => c.id === selectedCategory.value);\n    return category ? category.name : '';\n  }\n\n  function getCategoryItems(categoryId) {\n    // 获取基础数据\n    let items;\n    if (isSearchMode.value) {\n      // 返回搜索结果\n      items = [...searchResults.value];\n    } else if (categoryId === 'all') {\n      // 返回所有衣物 - 确保新添加的衣物也能显示\n      // 直接从store获取最新的衣物列表，避免响应式更新问题\n      items = [...clothingStore.clothingItems];\n    } else {\n      // 不使用计算属性，直接从store中过滤，确保能获取到最新添加的衣物\n      items = clothingStore.clothingItems.filter(\n        item =>\n          String(item.categoryId) === String(categoryId) ||\n          (item.category && String(item.category) === String(categoryId))\n      );\n    }\n\n    // 应用筛选\n    if (currentFilter.value === 'favorites') {\n      items = items.filter(item => item.favorite);\n    } else if (currentFilter.value === 'recent') {\n      // 按购买日期排序，与wardrobeStore中的recentlyAddedItems保持一致\n      items = [...items].sort((a, b) => {\n        const dateA = new Date(a.purchaseDate || 0);\n        const dateB = new Date(b.purchaseDate || 0);\n        return dateB - dateA;\n      });\n    }\n\n    // 应用排序\n    if (currentSort.value === 'name') {\n      items = [...items].sort((a, b) => a.name.localeCompare(b.name));\n    }\n\n    return items;\n  }\n\n  // 定义暴露的方法\n  import { defineExpose } from 'vue';\n\n  // 添加一个方法来刷新数据\n  function refreshWardrobeData() {\n    // 强制更新组件，确保新添加的衣物能立即显示\n    forceUpdate();\n  }\n\n  // 在<script setup>中使用defineExpose暴露方法\n  defineExpose({\n    refreshWardrobeData,\n  });\n\n  // 强制更新组件的key\n  const forceUpdateKey = ref(0);\n\n  function forceUpdate() {\n    forceUpdateKey.value++;\n    nextTick(() => {\n      console.log('组件已强制更新');\n    });\n  }\n\n  onMounted(() => {\n    initializeData();\n\n    // 监听全局查看全部衣物事件\n    document.addEventListener('view-all-clothing', viewAllCategories);\n  });\n\n  onUnmounted(() => {\n    // 清理事件监听器\n    document.removeEventListener('view-all-clothing', viewAllCategories);\n  });\n\n  function selectCategory(categoryId) {\n    console.log('点击分类，ID:', categoryId);\n    console.log('当前选中分类:', clothingStore.selectedCategory);\n    console.log('所有分类:', categories.value);\n    console.log('所有衣物:', clothingStore.clothingItems);\n\n    // 如果当前是搜索模式，先退出搜索模式\n    if (isSearchMode.value) {\n      isSearchMode.value = false;\n      searchResults.value = [];\n    }\n\n    // 重置筛选和排序状态\n    currentFilter.value = 'all';\n    currentSort.value = null;\n\n    if (clothingStore.selectedCategory === categoryId) {\n      console.log('清除选中分类');\n      clothingStore.clearSelectedCategory();\n      // 关闭抽屉\n      isDrawerOpen.value = false;\n    } else {\n      console.log('设置选中分类:', categoryId);\n      clothingStore.setSelectedCategory(categoryId);\n      // 打开抽屉\n      isDrawerOpen.value = true;\n    }\n\n    console.log('更新后选中分类:', clothingStore.selectedCategory);\n\n    // 强制更新组件\n    forceUpdate();\n  }\n\n  async function toggleFavorite(item) {\n    try {\n      await clothingStore.updateClothingItem(item.id, { favorite: !item.favorite });\n      showToast(item.favorite ? '已取消收藏' : '已添加到收藏', 'success');\n    } catch (error) {\n      showToast('操作失败，请重试', 'error');\n    }\n  }\n\n  async function handleSearch(keyword) {\n    console.log('开始搜索，关键词:', keyword);\n    console.log('当前衣物数据:', clothingStore.clothingItems);\n\n    if (!keyword.trim()) {\n      // 搜索关键词为空，退出搜索模式\n      isSearchMode.value = false;\n      searchResults.value = [];\n      clothingStore.clearSelectedCategory(); // 清除分类选择\n      return;\n    }\n\n    // 进入搜索模式\n    isSearchMode.value = true;\n\n    // 从当前衣物数据中搜索\n    const allItems = clothingStore.clothingItems;\n    console.log('搜索范围衣物:', allItems);\n\n    // 简单的关键词匹配\n    const results = allItems.filter(item => {\n      const name = (item.name || '').toLowerCase();\n      const description = (item.description || '').toLowerCase();\n      const categoryName = (item.categoryName || '').toLowerCase();\n      const searchQuery = keyword.toLowerCase();\n\n      return (\n        name.includes(searchQuery) ||\n        description.includes(searchQuery) ||\n        categoryName.includes(searchQuery)\n      );\n    });\n\n    console.log('搜索结果:', results);\n    searchResults.value = results;\n\n    // 搜索时清除分类选择\n    clothingStore.clearSelectedCategory();\n\n    try {\n      // 保存搜索关键词\n      currentSearchKeyword.value = keyword;\n      showToast(`找到 ${results.length} 件相关衣物`, 'success');\n      // 打开抽屉展示\n      isDrawerOpen.value = true;\n    } catch (error) {\n      showToast('搜索失败，请重试', 'error');\n    }\n  }\n\n  async function initializeData() {\n    await clothingStore.fetchCategories();\n    await clothingStore.fetchClothingItems();\n    console.log('衣物数据加载完成:', clothingStore.clothingItems);\n    console.log('分类数据加载完成:', clothingStore.categories);\n  }\n\n  function closeDrawer() {\n    // 如果是搜索模式，清除搜索状态\n    if (isSearchMode.value) {\n      isSearchMode.value = false;\n      searchResults.value = [];\n    } else {\n      clothingStore.clearSelectedCategory();\n    }\n    // 重置筛选和排序状态\n    currentFilter.value = 'all';\n    currentSort.value = null;\n    isDrawerOpen.value = false;\n  }\n\n  function viewItemDetail(item) {\n    // 设置当前查看的衣物\n    editingItem.value = item;\n    // 打开编辑模态框，设置为只读模式\n    isEditorOpen.value = true;\n    isReadOnlyMode.value = true;\n  }\n\n  function editItem(item) {\n    // 设置当前编辑的衣物\n    editingItem.value = item;\n    // 打开编辑模态框\n    isEditorOpen.value = true;\n  }\n\n  async function deleteItem(item) {\n    // 删除衣物的逻辑\n    if (confirm(`确定要删除 \"${item.name}\" 吗？此操作不可撤销。`)) {\n      try {\n        await clothingStore.deleteClothingItem(item.id);\n        showToast('衣物已成功删除', 'success');\n        // 如果删除后当前分类为空，关闭抽屉\n        if (getCategoryItems(selectedCategory.value).length === 1) {\n          closeDrawer();\n        }\n      } catch (error) {\n        showToast('删除失败，请重试', 'error');\n      }\n    }\n  }\n\n  function viewAllCategories() {\n    // 查看所有分类的逻辑\n    // 如果当前是搜索模式，先退出搜索模式\n    if (isSearchMode.value) {\n      isSearchMode.value = false;\n      searchResults.value = [];\n    }\n    // 重置筛选和排序状态\n    currentFilter.value = 'all';\n    currentSort.value = null;\n    // 设置一个特殊值表示查看全部\n    clothingStore.setSelectedCategory('all');\n\n    // 强制更新组件，确保显示最新添加的衣物\n    forceUpdate();\n\n    isDrawerOpen.value = true;\n  }\n\n  // 筛选处理函数\n  function handleFilter(filterType) {\n    currentFilter.value = filterType;\n    // 强制更新组件，以应用筛选\n    forceUpdate();\n  }\n\n  // 排序处理函数\n  function handleSort(sortType) {\n    currentSort.value = sortType;\n    // 强制更新组件，以应用排序\n    forceUpdate();\n  }\n\n  // 处理编辑保存\n  function handleEditSaved() {\n    // 编辑保存后强制更新组件，刷新数据\n    forceUpdate();\n  }\n\n  // 关闭编辑器\n  function closeEditor() {\n    isEditorOpen.value = false;\n    editingItem.value = null;\n    isReadOnlyMode.value = false;\n  }\n\n  // 生命周期\n  onMounted(() => {\n    initializeData();\n  });\n</script>\n\n<style scoped>\n  .animate-fadeIn {\n    animation: fadeIn 0.5s ease-in-out;\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n      transform: translateY(10px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n\n  /* 过渡动画 */\n  .fade-enter-active,\n  .fade-leave-active {\n    transition: opacity 0.3s ease;\n  }\n\n  .fade-enter-from,\n  .fade-leave-to {\n    opacity: 0;\n  }\n\n  .animated {\n    animation-duration: 1s;\n    animation-fill-mode: both;\n  }\n\n  .slide-up-enter-active {\n    animation-name: slideUpIn;\n    animation-duration: 1s;\n  }\n\n  .slide-up-leave-active {\n    animation-name: slideUpOut;\n    animation-duration: 0.3s;\n  }\n\n  .slide-up-enter-from {\n    transform: translateY(100%) scale(0.95);\n    opacity: 0;\n  }\n\n  .slide-up-enter-to {\n    transform: translateY(0) scale(1);\n    opacity: 1;\n  }\n\n  .slide-up-leave-from {\n    transform: translateY(0) scale(1);\n    opacity: 1;\n  }\n\n  .slide-up-leave-to {\n    transform: translateY(100%) scale(0.95);\n    opacity: 0;\n  }\n\n  @keyframes slideUpIn {\n    from {\n      transform: translateY(100%) scale(0.95);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0) scale(1);\n      opacity: 1;\n    }\n  }\n\n  @keyframes slideUpOut {\n    from {\n      transform: translateY(0) scale(1);\n      opacity: 1;\n    }\n    to {\n      transform: translateY(100%) scale(0.95);\n      opacity: 0;\n    }\n  }\n\n  /* 隐藏滚动条但保持滚动功能 */\n  .scrollbar-hide::-webkit-scrollbar {\n    display: none;\n  }\n\n  .scrollbar-hide {\n    -ms-overflow-style: none;\n    scrollbar-width: none;\n  }\n\n  /* 交错淡入动画 */\n  .staggered-fade-enter-active {\n    transition: all 0.5s ease;\n  }\n\n  .staggered-fade-enter-from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n\n  .staggered-fade-enter-to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n\n  /* 向上淡入动画 */\n  .fade-up-enter-active,\n  .fade-up-leave-active {\n    transition: all 0.6s ease;\n  }\n\n  .fade-up-enter-from {\n    opacity: 0;\n    transform: translateY(30px);\n  }\n\n  .fade-up-enter-to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n\n  /* 浮动动画 */\n  @keyframes float {\n    0%,\n    100% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-10px);\n    }\n  }\n\n  .animate-float {\n    animation: float 3s ease-in-out infinite;\n  }\n\n  /* 慢速脉冲动画 */\n  @keyframes pulse-slow {\n    0%,\n    100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.7;\n    }\n  }\n\n  .animate-pulse-slow {\n    animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n  }\n\n  /* 慢速扩散动画 */\n  @keyframes ping-slow {\n    75%,\n    100% {\n      transform: scale(1.5);\n      opacity: 0;\n    }\n  }\n\n  .animate-ping-slow {\n    animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite;\n  }\n\n  /* 弹跳进入动画 */\n  @keyframes bounce-in {\n    0% {\n      transform: scale(0.8);\n      opacity: 0;\n    }\n    50% {\n      transform: scale(1.1);\n    }\n    100% {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n\n  .animate-bounce-in {\n    animation: bounce-in 0.5s ease-out;\n  }\n\n  /* 延迟淡入动画 */\n  @keyframes fade-in-delay {\n    from {\n      opacity: 0;\n      transform: translateY(10px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n\n  .animate-fade-in-delay {\n    animation: fade-in-delay 0.5s ease-out;\n  }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}